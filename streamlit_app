import streamlit as st
import psycopg2
from sqlalchemy import create_engine

def get_connection():
    return psycopg2.connect(
        host=st.secrets["DB_HOST"],
        database=st.secrets["DB_NAME"],
        user=st.secrets["DB_USER"],
        password=st.secrets["DB_PASS"],
        port=st.secrets["DB_PORT"]
    )

def get_engine():
    url = f"postgresql+psycopg2://{st.secrets['DB_USER']}:{st.secrets['DB_PASS']}@" \
          f"{st.secrets['DB_HOST']}:{st.secrets['DB_PORT']}/{st.secrets['DB_NAME']}"
    return create_engine(url)
